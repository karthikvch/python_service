# This workflow will install Python dependencies, run tests and lint with a single version of Python
# For more information see: https://docs.github.com/en/actions/automating-builds-and-tests/building-and-testing-python

name: Python application

on:
  push:
       tags:
         - 'release/*'
jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v3
    - name: Import Script Parameter
      if: always()
      run: |
            json_string=`cat version-release.json`
            echo app version is $json_string
            app_version=`cat version-release.json|grep unified_version|cut -d ":" -f2`
            app_version="${app_version//'%'/'%25'}"
            app_version="${app_version//$'\n'/'%0A'}"
            app_version="${app_version//$'\r'/'%0D'}"
            echo app version is $app_version
    - name: Test with pytest
      run: |
            filename='python-test-v'
            file_ext='.zip'
            bash test_relase.sh $filename$app_version$file_ext
            echo build done
